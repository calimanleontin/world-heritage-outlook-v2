@map-footer-height: 115 * @rem-multiplier--desktop;
@map-scrolldown-height: 60 * @rem-multiplier--desktop;

// if logged in as admin
// @media @grid-desktop {
//   .path-frontpage.toolbar-vertical #block-homepagemap {
//     .col-left {
//       min-height: ~'calc(100vh - @{navbar-height} - @{map-footer-height} - 39px + (@{map-scrolldown-height} * 5 / 4))';
//     }
//   }
// }
.path-frontpage {
  #block-homepagemap {
    @media @grid-desktop {
      .row.map-block-main {
        display: flex;
      }
      .col-left {
        box-shadow: 8px 0 10px -9px fade(#000, 30%);
        font-size: 15 * @rem-multiplier--desktop;
        z-index: 1;
        max-width: 300px;
        height: ~'calc(100vh - @{navbar-height} - @{map-footer-height} + (@{map-scrolldown-height} * 5 / 4))';
        overflow: auto;
      }
      .col-right {
        position: relative;
        overflow: hidden;
        flex: 1;
        .map-container {
          position: static !important;
          height: 100% !important;
        }
      }
      .map-block-footer {
        .background-variant(@iucn-blue-dark, #fff);
        align-items: center;
        display: flex;
        flex-direction: column;
        font-size: 37 * @rem-multiplier--desktop;
        justify-content: center;
        min-height: @map-footer-height;
        position: relative;
        text-align: center;
        z-index: 1;
        .scroll-down {
          background-color: #fff;
          background-image: url(~'@{images-path}scroll-down-caret.svg');
          background-position: center 65%;
          background-repeat: no-repeat;
          background-size: 66%;
          border-radius: 50%;
          display: block;
          height: 60 * @rem-multiplier--desktop;
          position: absolute;
          top: 0;
          transform: translateY(-50%);
          width: 60 * @rem-multiplier--desktop;
          box-shadow: 0 -1px 8px -2px fade(#000, 30%);
        }
      }
    }
  }

  #map-site-search,
  #map-filters,
  #map-site-details {
    clear: both;
  }
  #map-site-search {
    .background-variant(@iucn-blue-dark, #fff);
    padding: 16 / 15 * 1em;
  }
  #map-filters {
    padding: 2em (16 / 15 * 1em);
    position: relative;
    h3 {
      font-size: 1.13em; // 17px
      margin-top: 0;
    }
    a[data-filter="all"] {
      color: @iucn-blue-light;
      float: right;
    }
    ul {
      list-style-type: none;
      margin-left: -16 / 15 * 1em;
      margin-right: -16 / 15 * 1em;
    }
    li {
      padding-left: 1em;
    }
    li.active {
      background-color: @iucn-gray-lightest;
      // @todo: checkbox mixin
      &:before {
        content: '';
        background-color: @iucn-blue-light;
        background-image: url(~'@{images-path}checkbox.svg');
        background-position: center;
        background-repeat: no-repeat;
        background-size: auto 60%;
        display: block;
        height: 1em * @line-height-base;
        overflow: hidden;
        position: absolute;
        // right: calc(~'100% - .5em');
        left: 0;
        text-indent: 999px;
        width: 1.5em;
      }
      .loop-conservation-ratings({
        &.@{conservation-rating-class}:before {
          background-color: @conservation-rating-color;
        }
      });
    }

    // Links and disk colours
    li > a {
      background-size: 1em * @line-height-base;
      background-repeat: no-repeat;
      display: block;
      padding-left: 1.5em;
      .loop-conservation-ratings({
        &.@{conservation-rating-class} {
          background-image: url('/modules/iucn/iucn_who_homepage/images/marker-@{conservation-rating-class}.png');
          color: @conservation-rating-color;
        }
      });
    }
  }
  #map-site-details {
    .site-selection-placeholder {
      color: #a6a7a7;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      margin: 0 auto;
      margin-bottom: 4em;
      margin-top: 4em;
      min-height: 245 * @rem-multiplier--desktop;
      padding-left: 1.5em;
      padding-right: 1.5em;
      text-align: center;
      width: 80%;
      &:before, &:after {
        border: 1px solid @iucn-gray-lighter;
        content: '';
        display: block;
        height: 1.5em;
        width: 100%;
      }
      &:before {
        border-bottom: none;
      }
      &:after {
        border-top: none;
      }
      img {
        // height: @line-height-base * 1em;
        display: block;
        margin: 0 auto;
      }
    }
    .map-site-detail {
      position: relative;
      padding-top: 1px; // prevent margin collapse
      > div,
      > dl {
        padding-left: 1.5em;
      }
      > div,
      > dl,
      > .more {
        padding-right: .5em;
      }
      .status {
        background-color: #fff;
        font-size: 1.06em;
        font-weight: 300;
        left: 0;
        padding: .3em 2em;
        position: absolute;
        top: 1px; // compensate for 1px padding-top
        // @todo: remove unnecessary conservation rating classes
        .loop-conservation-ratings({
          &.@{conservation-rating-class} {
            background-color: @conservation-rating-color;
            color: #fff;
          }
        });
        + .title {
          margin-top: 3em;
        }
      }
      .title {
        border-left: .4em solid;
        padding-bottom: .5em;
        padding-left: 1em;
        padding-right: .5em;
        padding-top: .5em;
        .loop-conservation-ratings({
          &.@{conservation-rating-class} {
            color: @conservation-rating-color;
          }
        });
      }
      .country {
        font-weight: 300;
        color: #787878;
      }
      dl {
        color: #666666;
        float: left;
        margin-top: .5em;
        padding-left: 10 * @rem-multiplier--desktop;
        padding-right: 10 * @rem-multiplier--desktop;
        width: 100%;
      }
      dt {
        clear: both;
        float: left;
        padding-bottom: .5em;
        padding-left: 1.5em;
        padding-top: .5em;
        width: 50%;
        &.values,
        &.threats,
        &.protection {
          position: relative;
          &:before {
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;
            content: '';
            display: block;
            height: 100%;
            margin-top: -.5em;
            position: absolute;
            left: 0;
            // right: 100%;
            // top: 0;
            width: 1.3em;
            margin-right: .5em;
          }
        }
        &.values:before {
          background-image: url(~'@{images-path}values.svg');
        }
        &.threats:before {
          background-image: url(~'@{images-path}threats.svg');
        }
        &.protection:before {
          background-image: url(~'@{images-path}protection.svg');
          width: 1.4em;
        }
      }
      dd {
        padding-bottom: .5em;
        padding-top: .5em;
        position: relative;
        font-weight: 300;
        &:before {
          border-top: 1px solid @iucn-gray-lighter;
          content: '';
          display: block;
          position: absolute;
          top: 0;
          width: 100%;
        }
      }

      .more {
        float: right;
        color: @iucn-blue-light;
        &:after {
          background-image: url('@{images-path}icon-arrow.svg');
          background-repeat: no-repeat;
          background-size: contain;
          content: '';
          display: inline-block;
          height: 1em;
          margin-left: .5em;
          vertical-align: middle;
          width: 2em;
        }
      }
      .close {
        background-color: @iucn-blue-dark;
        color: #fff;
        display: block;
        font-size: 1em;
        font-weight: 300;
        opacity: 1;
        padding: .8em 1em;
        position: absolute;
        right: 0;
        top: 1px; // compensate for 1px padding-top
      }
      img {
        &:extend(.img-responsive);
        width: 100%;
        // @todo: remove this and use custom image style
        height: 10vh;
        min-height: 120 * @rem-multiplier--desktop;
        max-height: 140 * @rem-multiplier--desktop;
        object-fit: cover;
        @media (orientation: portrait) {
          // height: 20vh;
        }
        @media @design-desktop {
          height: 140 * @rem-multiplier--desktop;
        }
      }
      .inscription {
        strong {
          font-weight: inherit;
        }
      }
    }
  }
  #block-globaloutlookstatistics {
    text-align: center;
    // Links and disk colours
    .loop-conservation-ratings({
      dt.@{conservation-rating-class} {
         color: @conservation-rating-color;
      }
      .bg-@{conservation-rating-class} {
        background-color: @conservation-rating-color;
        &:after {
          border-top-color: @conservation-rating-color;
        }
      }
    });
    dt, dd {
      float: left;
      width: 50%;
      margin-bottom: .3em;
    }
    dt {
      clear: both;
      margin-right: 1em;
      text-align: right;
      width: calc(~'50% - 1em');
    }
    dd { color: white; font-weight: bold; }
    dd>div {
      box-sizing: initial;
      padding: 0 1em;
      position: relative;
      text-align: center;
      &:after {
        border-bottom-color: transparent;
        border-left-color: transparent;
        border-right-color: transparent;
        border-style: solid;
        border-width: (@line-height-base * 1em) (@line-height-base * 1em) 0 0;
        content: '';
        display: inline-block;
        height: 0;
        left: 100%;
        position: absolute;
        top: 0;
        width: 0;
      }
    }

    dl { display: block; width: 50%; margin: 0 auto; }
  }
  #block-homepagereport {
    text-align: center;
    margin-top: 3em;
    a {
      .btn-info();
      display: inline-block;
      text-align: left;
      width: auto;
      font-size: 22px;
      padding: .5em 1.5em;
      position: relative;
      line-height: 1.2;
      padding-left: 5em;
      font-weight: 300;
      div {
        font-size: 15px;
      }
      .glyphicon {
        background-image: url(~'@{images-path}download-report.svg');
        background-position: center;
        background-repeat: no-repeat;
        background-size: (44 / 22 * 1em) auto;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 4em;
        &:before {
          display: none;
        }
        &:after {
          border-right: 1px solid;
          content: '';
          display: block;
          height: 80%;
          position: absolute;
          right: 0;
          top: 10%;
        }
      }

    }
  }
}

#scroll-down-target {
  height: 10px;
}
