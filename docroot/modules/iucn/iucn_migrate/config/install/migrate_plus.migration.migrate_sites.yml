langcode: en
status: true
id: iucn_migrate_sites
migration_group: iucn migrations
label: Sites
source:
  plugin: iucn_migrate_source_url
  data_fetcher_plugin: http
  data_parser_plugin: json
  urls: /json/iucn_sites
  ids:
     site_id:
      type: integer
  fields:
    -
      name: site_id
      label: 'site id'
      selector: siteId
    -
      name: site_name
      label: 'site name'
      selector: nameEn
    -
      name: site_wdpa_id
      label: 'site wpda id'
      selector: wdpaId
    -
      name: site_unesco_id
      label: 'site unseco id'
      selector: unescoId
    -
      name: site_name_fr
      label: 'site name fr'
      selector: nameFr
    -
      name: site_description
      label: 'site description'
      selector: description
    -
      name: site_inscription_year
      label: 'site inscription year'
      selector: inscriptionYear
    -
      name: site_active
      label: 'site active'
      selector: active
    -
      name: site_transboundary
      label: 'site transboundary'
      selector: transboundary
    -
      name: site_mixed
      label: 'site mixed site'
      selector: mixedSite
    -
      name: site_cultural_landscape
      label: 'site cultural landscape'
      selector: culturalLandscape
    -
      name: site_area
      label: 'site area'
      selector: area
    -
      name: site_buffer_zone
      label: 'site buffer zone'
      selector: bufferZone
    -
      name: site_buffer_zone_area
      label: 'site buffer zone area'
      selector: bufferZoneArea
    -
      name: site_serial
      label: 'site serial'
      selector: serial
    -
      name: site_categories
      label: 'site categories'
      selector: iucnPaCategories
    -
      name: site_inscription_criteria
      label: 'site inscription criteria'
      selector: inscriptionCriteria
    -
      name: site_country
      label: 'site country'
      selector: countries
    -
      name: site_designation
      label: 'site designation'
      selector: otherDesignations
    -
      name: site_theme
      label: 'site theme'
      selector: thematics
process:
  type:
    plugin: default_value
    default_value: site
  field_site_id: site_id
  title: site_name
  field_wdpa_id: site_wdpa_id
  field_unesco_id: site_unesco_id
  field_site_name_fr: site_name_fr
  body/value: site_description
  field_inscription_year: site_inscription_year
  status: site_active
  field_transboundary: site_transboundary
  field_mixed_site: site_mixed
  field_cultural_landscape: site_cultural_landscape
  field_area: site_area
  field_buffer_zone: site_buffer_zone
  field_buffer_zone_area: site_buffer_zone_area
  field_serial: site_serial
  field_category:
     plugin: entity_generate
     source: site_categories
     entity_type: taxonomy_term
     bundle_key: vid
     bundle: category
     value_key: name
  field_inscription_criteria:
     plugin: entity_generate
     source: site_inscription_criteria
     entity_type: taxonomy_term
     bundle_key: vid
     bundle: inscription_criteria
     value_key: name
  field_country:
    plugin: entity_generate
    source: site_country
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: country
    value_key: name
  field_designation:
    plugin: entity_generate
    source: site_designation
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: designation
    value_key: name
  field_theme:
    plugin: entity_generate
    source: site_theme
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: theme
    value_key: name
  uid:
    plugin: default_value
    default_value: 1
destination:
  plugin: 'entity:node'
migration_dependencies:
  required:
    - iucn_migrate_categories
    - iucn_migrate_thematics
    - iucn_migrate_designations
    - iucn_migrate_criterias
    - iucn_migrate_countries
